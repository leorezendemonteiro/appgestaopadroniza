<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>App de Gestão - DRE V13</title>

  <!-- Tailwind e fontes -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- Config Firebase -->
  <script>
    window.__firebase_config = JSON.stringify({
      apiKey: "SUA_API_KEY",
      authDomain: "SEU_PROJETO.firebaseapp.com",
      projectId: "SEU_PROJETO",
      storageBucket: "SEU_PROJETO.appspot.com",
      messagingSenderId: "SEU_SENDER_ID",
      appId: "SEU_APP_ID"
    });
  </script>

  <style>
    body { font-family: 'Inter', sans-serif; }
    .dre-item { display: flex; justify-content: space-between; padding: 0.75rem; border-bottom: 1px solid #e5e7eb; }
    .dre-item.total { font-weight: 700; background-color: #f9fafb; }
    .dre-item.net-profit { font-weight: 700; background-color: #d1fae5; color: #065f46; }
    .dre-item.net-loss { font-weight: 700; background-color: #fee2e2; color: #991b1b; }
    .tab-button.active { border-color: #3b82f6; background-color: #eff6ff; color: #2563eb; }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .indicator-item { background-color: #f9fafb; padding: 1rem; border-radius: 0.5rem; }
    #splash-screen {
      background-image: linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.6)), url('https://images.pexels.com/photos/586744/pexels-photo-586744.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1');
      background-size: cover;
      background-position: center;
    }
    #app-status {
      text-align: center;
      font-size: 0.875rem;
      color: #4B5563;
      margin-top: 1rem;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800">

  <p id="app-status">Inicializando app...</p>

  <div id="splash-screen" class="min-h-screen flex flex-col justify-center items-center text-center p-6">
    <img src="https://i.postimg.cc/vBvK9KGz/ges.jpg" alt="Logo da Padroniza" class="h-24 mb-8">
    <div class="bg-white/90 backdrop-blur-sm p-8 rounded-2xl shadow-2xl max-w-md w-full">
      <h1 class="text-2xl font-bold text-gray-800 mb-2">Bem-vindo(a)</h1>
      <p class="text-gray-600 mb-6">Insira os dados da empresa para começar.</p>
      <div class="space-y-4">
        <input type="text" id="company-name" placeholder="Razão Social" class="w-full px-4 py-2 border rounded-lg">
        <input type="text" id="company-cnpj" placeholder="CNPJ" class="w-full px-4 py-2 border rounded-lg">
        <button id="start-app-btn" class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition-transform hover:scale-105 disabled:bg-gray-400 disabled:cursor-not-allowed" disabled>Aguarde...</button>
      </div>
    </div>
  </div>

  <div id="main-app" style="display: none;"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

    const firebaseConfig = JSON.parse(window.__firebase_config || '{}');
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    let currentUserId = null;

    const splashScreen = document.getElementById('splash-screen');
    const mainApp = document.getElementById('main-app');
    const startAppBtn = document.getElementById('start-app-btn');
    const appStatus = document.getElementById('app-status');

    appStatus.textContent = "Conectando ao Firebase...";

    onAuthStateChanged(auth, (user) => {
      if (user) {
        currentUserId = user.uid;
        startAppBtn.disabled = false;
        startAppBtn.textContent = 'Iniciar DRE';
        appStatus.textContent = "Conectado!";
      } else {
        signInAnonymously(auth).catch(error => {
          console.error("Erro ao autenticar:", error);
          startAppBtn.textContent = 'Erro ao Conectar';
          appStatus.textContent = "Erro ao conectar com o Firebase.";
        });
      }
    });

    startAppBtn.addEventListener('click', () => {
      if (!currentUserId) {
        alert("Aguarde a conexão com o servidor.");
        return;
      }

      const companyName = document.getElementById('company-name').value || 'Empresa Sem Nome';
      const companyCnpj = document.getElementById('company-cnpj').value || 'CNPJ não informado';

      document.getElementById('header-company-name')?.textContent = companyName;
      document.getElementById('header-company-cnpj')?.textContent = `CNPJ: ${companyCnpj}`;

      splashScreen.style.display = 'none';
      mainApp.style.display = 'block';
    });
  </script>
</body>
</html>
