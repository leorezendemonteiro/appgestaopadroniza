<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CORRETAGESTAO02</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .input {
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 0.25rem;
      width: 100%;
    }
    .botao {
      background-color: #16a34a;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.25rem;
      width: 100%;
    }
    .aba {
      padding: 0.5rem 1rem;
      border-radius: 0.25rem;
      background-color: #e5e7eb;
      transition: 0.3s;
      white-space: nowrap;
    }
    .aba:hover {
      background-color: #2563eb;
      color: white;
    }
  </style>
</head>
<body class="bg-gray-100">
  <div id="telaInicial" class="flex flex-col items-center justify-center h-screen p-4">
    <h1 class="text-2xl font-bold mb-4">üìä Padroniza DRE</h1>
    <form id="formInicio" class="w-full max-w-xs">
      <input id="empresaNome" type="text" placeholder="Nome da Empresa" class="mb-2 input" />
      <input id="empresaCNPJ" type="text" placeholder="CNPJ" class="mb-4 input" />
      <button type="submit" class="botao">Iniciar DRE</button>
    </form>
  </div>

  <div id="app" class="hidden p-4">
    <div class="flex gap-2 mb-4 overflow-x-auto">
      <button onclick="abrirAba('calibracao')" class="aba">Calibra√ß√£o</button>
      <button onclick="abrirAba('receitas')" class="aba">Receitas</button>
      <button onclick="abrirAba('cmv')" class="aba">CMV</button>
      <button onclick="abrirAba('fixas')" class="aba">Fixas</button>
      <button onclick="abrirAba('maoObra')" class="aba">M√£o de Obra</button>
      <button onclick="abrirAba('relatorio')" class="aba">Relat√≥rio</button>
    </div>
    <div id="conteudo"></div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const conteudo = document.getElementById("conteudo");

      document.getElementById("formInicio").addEventListener("submit", function (e) {
        e.preventDefault();
        iniciarApp();
      });

      window.iniciarApp = function () {
        const nome = document.getElementById("empresaNome").value;
        const cnpj = document.getElementById("empresaCNPJ").value;
        if (!nome || !cnpj) return alert("Preencha todos os campos.");
        localStorage.setItem("empresaNome", nome);
        localStorage.setItem("empresaCNPJ", cnpj);
        document.getElementById("telaInicial").classList.add("hidden");
        document.getElementById("app").classList.remove("hidden");
        abrirAba("calibracao");
      };

      window.abrirAba = function (aba) {
        const fn = {
          calibracao: renderCalibracao,
          receitas: renderReceitas,
          cmv: renderCmv,
          fixas: renderFixas,
          maoObra: renderMo,
          relatorio: renderRelatorio
        };
        fn[aba]?.();
      };

      function salvarItem(chave, item) {
        const dados = JSON.parse(localStorage.getItem(chave) || "[]");
        dados.push(item);
        localStorage.setItem(chave, JSON.stringify(dados));
      }

      function excluirItem(chave, index) {
        const dados = JSON.parse(localStorage.getItem(chave) || "[]");
        dados.splice(index, 1);
        localStorage.setItem(chave, JSON.stringify(dados));
        abrirAba(chave);
      }

      function renderCalibracao() {
        conteudo.innerHTML = `
        <div class="space-y-2">
          <input id="imposto" class="input" placeholder="Imposto sobre faturamento (%)">
          <input id="debito" class="input" placeholder="Taxa de d√©bito (%)">
          <input id="credito" class="input" placeholder="Taxa de cr√©dito (%)">
          <input id="apps" class="input" placeholder="Comiss√£o de apps/iFood (%)">
          <input id="app99" class="input" placeholder="Comiss√£o de apps/99 (%)">
          <input id="encargos" class="input" placeholder="Encargos diversos (%)">
          <button onclick="salvarCalibracao()" class="botao">Salvar Calibra√ß√£o</button>
        </div>`;
      }

      window.salvarCalibracao = function () {
        const dados = {
          imposto: document.getElementById("imposto").value,
          debito: document.getElementById("debito").value,
          credito: document.getElementById("credito").value,
          apps: document.getElementById("apps").value,
          app99: document.getElementById("app99").value,
          encargos: document.getElementById("encargos").value
        };
        localStorage.setItem("calibracao", JSON.stringify(dados));
        alert("Calibra√ß√£o salva!");
      };

      function renderReceitas() {
        conteudo.innerHTML = `
        <div class="space-y-2">
          <input id="descReceita" class="input" placeholder="Descri√ß√£o">
          <input id="valorReceita" class="input" type="number" placeholder="Valor (R$)">
          <input id="dataReceita" class="input" type="date">
          <select id="formaRecebimento" class="input">
            <option value="Cr√©dito">Cr√©dito</option>
            <option value="D√©bito">D√©bito</option>
            <option value="Pix">Pix</option>
            <option value="Dinheiro">Dinheiro</option>
            <option value="iFood">iFood</option>
            <option value="99">99</option>
          </select>
          <button onclick="salvarReceita()" class="botao">Salvar Receita</button>
        </div>
        <div id="listaReceitas" class="mt-4 space-y-1"></div>`;
        renderLista("receitas", "listaReceitas");
      }

      window.salvarReceita = function () {
        const item = {
          desc: document.getElementById("descReceita").value,
          valor: parseFloat(document.getElementById("valorReceita").value),
          data: document.getElementById("dataReceita").value,
          forma: document.getElementById("formaRecebimento").value
        };
        salvarItem("receitas", item);
        abrirAba("receitas");
      };

      function renderCmv() {
        conteudo.innerHTML = `
        <div class="space-y-2">
          <select id="categoriaCmv" class="input">
            <option>Alimentar</option>
            <option>Produtos de limpeza e higiene</option>
            <option>Embalagens e descart√°veis</option>
            <option>G√°s</option>
            <option>Bebidas e similares</option>
            <option>Outros</option>
          </select>
          <input id="descCmv" class="input" placeholder="Descri√ß√£o">
          <input id="valorCmv" class="input" type="number" placeholder="Valor (R$)">
          <input id="dataCmv" class="input" type="date">
          <input id="fornecedorCmv" class="input" placeholder="Fornecedor">
          <button onclick="salvarDespesa('cmv')" class="botao">Salvar Despesa Vari√°vel</button>
        </div>
        <div id="listaCmv" class="mt-4 space-y-1"></div>`;
        renderLista("cmv", "listaCmv");
      }

      function renderFixas() {
        conteudo.innerHTML = `
        <div class="space-y-2">
          <select id="categoriaFixas" class="input">
            <option>Aluguel</option><option>IPTU</option><option>√Ågua</option>
            <option>Energia el√©trica</option><option>Internet/telefone</option>
            <option>Mensalidade de software</option><option>Contabilidade</option>
            <option>Marketing</option><option>Parcela de financiamento</option>
            <option>Pr√≥labore</option>
          </select>
          <input id="valorFixas" class="input" type="number" placeholder="Valor (R$)">
          <input id="dataFixas" class="input" type="date">
          <input id="fornecedorFixas" class="input" placeholder="Fornecedor">
          <button onclick="salvarDespesa('fixas')" class="botao">Salvar Despesa Fixa</button>
        </div>
        <div id="listaFixas" class="mt-4 space-y-1"></div>`;
        renderLista("fixas", "listaFixas");
      }

      function renderMo() {
        conteudo.innerHTML = `
        <div class="space-y-2">
          <select id="categoriaMo" class="input">
            <option>Sal√°rios</option><option>F√©rias</option><option>Verbas rescis√≥rias</option>
            <option>INSS</option><option>FGTS</option><option>Vale transporte</option>
            <option>Vale alimenta√ß√£o</option><option>Exames peri√≥dicos</option><option>Uniformes</option>
          </select>
          <input id="valorMo" class="input" type="number" placeholder="Valor (R$)">
          <input id="dataMo" class="input" type="date">
          <input id="fornecedorMo" class="input" placeholder="Fornecedor">
          <button onclick="salvarDespesa('maoObra')" class="botao">Salvar M√£o de Obra</button>
        </div>
        <div id="listaMaoObra" class="mt-4 space-y-1"></div>`;
        renderLista("maoObra", "listaMaoObra");
      }

      window.salvarDespesa = function (tipo) {
        const item = {
          categoria: document.getElementById("categoria" + tipo.charAt(0).toUpperCase() + tipo.slice(1)).value,
          valor: parseFloat(document.getElementById("valor" + tipo.charAt(0).toUpperCase() + tipo.slice(1)).value),
          data: document.getElementById("data" + tipo.charAt(0).toUpperCase() + tipo.slice(1)).value,
          fornecedor: document.getElementById("fornecedor" + tipo.charAt(0).toUpperCase() + tipo.slice(1)).value
        };
        salvarItem(tipo, item);
        abrirAba(tipo);
      };

      function renderLista(nome, id) {
        const lista = JSON.parse(localStorage.getItem(nome)) || [];
        const html = lista.map((item, i) => \`<div class="bg-white p-2 shadow rounded flex justify-between"><span>\${item.data} - \${item.categoria || item.desc} - R$\${item.valor}</span><button onclick="excluirItem('\${nome}', \${i})" class="text-red-500">Excluir</button></div>\`).join("");
        document.getElementById(id).innerHTML = html;
      }

      function renderRelatorio() {
        conteudo.innerHTML = '<div class="p-4">Relat√≥rio completo ser√° implementado a seguir com PDF.</div>';
      }
    });
  </script>
</body>
</html>
