<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CORRETAGESTAO02</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    .input { padding: 0.5rem; border: 1px solid #ccc; border-radius: 0.25rem; width: 100%; }
    .botao { background-color: #16a34a; color: white; padding: 0.5rem 1rem; border-radius: 0.25rem; width: 100%; }
    .aba { padding: 0.5rem 1rem; border-radius: 0.25rem; background-color: #e5e7eb; transition: 0.3s; white-space: nowrap; }
    .aba:hover { background-color: #2563eb; color: white; }
    table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
    th, td { border: 1px solid #ccc; padding: 0.5rem; text-align: left; }
  </style>
</head>
<body class="bg-gray-100">
  <div id="telaInicial" class="flex flex-col items-center justify-center h-screen p-4">
    <h1 class="text-2xl font-bold mb-4">üìä Padroniza DRE</h1>
    <form id="formInicio" class="w-full max-w-xs">
      <input id="empresaNome" type="text" placeholder="Nome da Empresa" class="mb-2 input" />
      <input id="empresaCNPJ" type="text" placeholder="CNPJ" class="mb-4 input" />
      <button type="submit" class="botao">Iniciar DRE</button>
    </form>
  </div>

  <div id="app" class="hidden p-4">
    <div class="flex gap-2 mb-4 overflow-x-auto">
      <button onclick="abrirAba('calibracao')" class="aba">Calibra√ß√£o</button>
      <button onclick="abrirAba('receitas')" class="aba">Receitas</button>
      <button onclick="abrirAba('cmv')" class="aba">CMV</button>
      <button onclick="abrirAba('fixas')" class="aba">Fixas</button>
      <button onclick="abrirAba('maoObra')" class="aba">M√£o de Obra</button>
      <button onclick="abrirAba('relatorio')" class="aba">Relat√≥rio</button>
    </div>
    <div id="conteudo"></div>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const conteudo = document.getElementById("conteudo");
      const dados = {
        calibracao: JSON.parse(localStorage.getItem("calibracao")) || {},
        receitas: JSON.parse(localStorage.getItem("receitas")) || [],
        cmv: JSON.parse(localStorage.getItem("cmv")) || [],
        fixas: JSON.parse(localStorage.getItem("fixas")) || [],
        maoObra: JSON.parse(localStorage.getItem("maoObra")) || []
      };

      document.getElementById("formInicio").addEventListener("submit", function (e) {
        e.preventDefault();
        const nome = document.getElementById("empresaNome").value;
        const cnpj = document.getElementById("empresaCNPJ").value;
        if (!nome || !cnpj) return alert("Preencha todos os campos.");
        localStorage.setItem("empresaNome", nome);
        localStorage.setItem("empresaCNPJ", cnpj);
        document.getElementById("telaInicial").classList.add("hidden");
        document.getElementById("app").classList.remove("hidden");
        abrirAba("calibracao");
      });

      window.abrirAba = function (aba) {
        if (aba === "calibracao") renderCalibracao();
        if (aba === "receitas") renderReceitas();
        if (aba === "cmv") renderCMV();
        if (aba === "fixas") renderFixas();
        if (aba === "maoObra") renderMaoObra();
        if (aba === "relatorio") renderRelatorio();
      };

      function renderCalibracao() {
        conteudo.innerHTML = `
          <h2 class="text-xl font-bold mb-2">Calibra√ß√£o de Taxas</h2>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <input id="imp" class="input" placeholder="Imposto sobre faturamento (%)" value="${dados.calibracao.imp || ''}" />
            <input id="deb" class="input" placeholder="Taxa de d√©bito (%)" value="${dados.calibracao.deb || ''}" />
            <input id="cred" class="input" placeholder="Taxa de cr√©dito (%)" value="${dados.calibracao.cred || ''}" />
            <input id="ifood" class="input" placeholder="Comiss√£o de apps/ifood (%)" value="${dados.calibracao.ifood || ''}" />
            <input id="app99" class="input" placeholder="Comiss√£o de apps/99 (%)" value="${dados.calibracao.app99 || ''}" />
            <input id="encargos" class="input" placeholder="Encargos diversos" value="${dados.calibracao.encargos || ''}" />
          </div>
          <button onclick="salvarCalibracao()" class="mt-4 botao">Salvar Calibra√ß√£o</button>
        `;
      }

      window.salvarCalibracao = function () {
        const nova = {
          imp: document.getElementById("imp").value,
          deb: document.getElementById("deb").value,
          cred: document.getElementById("cred").value,
          ifood: document.getElementById("ifood").value,
          app99: document.getElementById("app99").value,
          encargos: document.getElementById("encargos").value
        };
        localStorage.setItem("calibracao", JSON.stringify(nova));
        alert("Calibra√ß√£o salva com sucesso!");
        abrirAba("calibracao");
      };

      function renderReceitas() {
        conteudo.innerHTML = `<div class="p-4">[Receitas funcional]</div>`;
      }

      function renderCMV() {
        conteudo.innerHTML = `<div class="p-4">[CMV funcional]</div>`;
      }

      function renderFixas() {
        conteudo.innerHTML = `<div class="p-4">[Fixas funcional]</div>`;
      }

      function renderMaoObra() {
        conteudo.innerHTML = `<div class="p-4">[M√£o de Obra funcional]</div>`;
      }

      function renderRelatorio() {
        conteudo.innerHTML = `<div class="p-4">[Relat√≥rio funcional com PDF]</div>`;
      }
    });
  </script>
</body>
</html>
